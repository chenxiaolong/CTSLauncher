# CTSLauncher

<img src="app/images/icon.svg" alt="app icon" width="72" />

![latest release badge](https://img.shields.io/github/v/release/chenxiaolong/CTSLauncher?sort=semver)
![license badge](https://img.shields.io/github/license/chenxiaolong/CTSLauncher)

CTSLauncher is a shortcut and quick settings tile for launching the contextual search activity in the Google app. It is useful for Android OS's that do not have the system-level contextual search integration with the Google app.

CTSLauncher does not require any permissions by default.

**NOTE**: The Google app determines whether Circle to Search or Google Assistant is launched (or even doing nothing), depending on the Android version and device model. CTSLauncher does **not** make Circle to Search work on devices where it is not supported.

## Usage

1. Download and install the latest version from the [releases page](https://github.com/chenxiaolong/CTSLauncher/releases). To verify the digital signature, see the [verifying digital signatures](#verifying-digital-signatures) section.

2. Make sure the Google app is set as the default assistant app in Android's Settings -> Apps -> Default apps -> Digital assistant app.

3. That's it! When CTSLauncher is opened, either via the app icon or quick settings tile, it will trigger the Google app's contextual search feature.

## Auto-switching assistant app

If the system has a different default assistant app set, CTSLauncher can automatically switch the assistant app to the Google app, launch CTS, and then restore the setting. This requires granting the `WRITE_SECURE_SETTINGS` permission via `adb`:

```bash
adb shell pm grant com.chiller3.ctslauncher android.permission.WRITE_SECURE_SETTINGS
```

To revoke the permissions, run:

```bash
adb shell pm revoke com.chiller3.ctslauncher android.permission.WRITE_SECURE_SETTINGS
```

## Verifying digital signatures

First, use `apksigner` to print the digests of the APK signing certificate:

```
apksigner verify --print-certs CTSLauncher-<version>-release.apk
```

Then, check that the SHA-256 digest of the APK signing certificate is:

```
d61af8941192f2a55139ab2f4f0087a9b5a8a078c9c06a96b026e3befca9bb89
```

## Building from source

CTSLauncher can be built like most other Android apps using Android Studio or the gradle command line.

To build the APK:

```bash
./gradlew assembleDebug
```

The APK will be signed with the default autogenerated debug key.

To create a release build with a specific signing key, set the following environment variables:

```bash
export RELEASE_KEYSTORE=/path/to/keystore.jks
export RELEASE_KEY_ALIAS=alias_name

read -r -s RELEASE_KEYSTORE_PASSPHRASE
read -r -s RELEASE_KEY_PASSPHRASE
export RELEASE_KEYSTORE_PASSPHRASE
export RELEASE_KEY_PASSPHRASE
```

and then build the release APK:

```bash
./gradlew assembleRelease
```

## License

CTSLauncher is licensed under GPLv3. Please see [`LICENSE`](./LICENSE) for the full license text.
